{"version":3,"sources":["../../src/pages/home/tabs/RoutesList/RoutesList.module.ts","../../src/pages/home/tabs/RoutesList/RoutesList.ts"],"names":[],"mappings":"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","file":"5.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { RoutesListPage } from './RoutesList';\nimport { TranslateModule } from '@ngx-translate/core';\nimport { ComponentsModule } from '../../../../components/components.module';\n\n@NgModule({\n  declarations: [\n    RoutesListPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(RoutesListPage),\n    TranslateModule.forChild(),\n    ComponentsModule\n  ],\n})\nexport class RoutesListPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/home/tabs/RoutesList/RoutesList.module.ts","import {Component, OnDestroy, ViewChild} from '@angular/core';\nimport {Content, IonicPage, ModalController, NavController, NavParams} from 'ionic-angular';\nimport {ConnectionQuality, Helper} from '../../../../classes/Helper';\nimport {timeout} from 'promise-timeout';\n\nimport {OrmService} from '../../../../services/orm-service';\nimport {Route} from '../../../../entity/Route';\nimport {ModalsService} from '../../../../services/modals-service';\nimport {DB_Updater} from '../../../../classes/DB_Updater';\nimport {Subscription} from 'rxjs/Subscription';\nimport {SpinnerDialog} from '@ionic-native/spinner-dialog';\nimport {TranslateService} from '@ngx-translate/core';\nimport {MCMRouteByCodeModal} from '../../../../modals/MCMRouteByCodeModal/MCMRouteByCodeModal';\nimport {GpsService} from '../../../../services/gps-service';\nimport {ChatAndSessionService} from \"../../../../services/chat-and-session-service\";\nimport {MCMIconModal} from \"../../../../modals/MCMIconModal/MCMIconModal\";\nimport {MCMModalType, MyApp} from \"../../../../app/app.component\";\nimport {SearchPipe} from \"../../../../app/pipes/search.pipe\";\n\n@IonicPage()\n@Component({\n    selector: 'routes-list',\n    templateUrl: 'RoutesList.html'\n})\nexport class RoutesListPage implements OnDestroy {\n    @ViewChild(Content) content: Content;\n    public items: Route[] = [];\n    public downloadedItems: Route[] = [];\n    public filteredItems: Route[] = [];\n    private routesListSearch: string = \"\";\n\n    private isOpeningRoute: boolean = false;\n    private pipe: SearchPipe;\n\n    private filteredResult: Route[];\n\n    private showAllRoutes: boolean = true;\n\n    modal: any;\n    private eventSubscription: Subscription;\n    /**\n     * How many elements shall be loaded each time the list is scrolled to the end.\n     * @type {number}\n     */\n    private infiniteScrollBlockSize = 20;\n\n    constructor(private ormService: OrmService,\n                public navCtrl: NavController,\n                public modalsService: ModalsService,\n                private modalCtrl: ModalController,\n                private spinner: SpinnerDialog,\n                private translateService: TranslateService,\n                private dbUpdater: DB_Updater,\n                public helper: Helper,\n                private gpsService: GpsService,\n                private chatAndSessionService: ChatAndSessionService,\n                private app: MyApp,\n                private navParams: NavParams,\n    ) {\n\n        this.eventSubscription = this.ormService.eventEmitter.subscribe(async (event) => {\n            this.downloadedItems = await this.ormService.getDownloadedRoutes(this.compareFunction);\n            this.items = await this.ormService.getVisibleRoutes(false, this.compareFunction);\n            this.sortAndRebuildFilteredItems();\n            this.filterItems();\n\n        });\n    }\n\n    ngOnDestroy() {\n        this.eventSubscription.unsubscribe();\n    }\n\n    public getRoutesList() {\n        return this.routesListSearch.length > 2 ? this.items : this.filteredItems;\n    }\n\n    async ionViewWillEnter() {\n        this.pipe = new SearchPipe();\n        if(this.navParams.data && this.navParams.data.showAllRoutes != null) {\n            this.showAllRoutes = this.navParams.data && this.navParams.data.showAllRoutes;\n        }\n        let activeUser = await this.ormService.getActiveUser();\n        if (!activeUser) {\n            // initial app start\n            let online = await this.modalsService.showNoInternetModalIfOffline();\n            if (online) {\n                this.spinner.show(null, this.translateService.instant('a_toast_update_start'), true);\n                try {\n                    await this.dbUpdater.checkForUpdates();\n                } catch (e) {\n                    console.error('caught error while checking for updates:');\n                    console.error(e);\n                }\n                await this.ormService.setNewActiveUser('Me');\n            }\n        } else {\n            // we need to check for updates\n            let quality = await this.helper.checkConnection();\n            if (quality == ConnectionQuality.FAST || quality == ConnectionQuality.SLOW) {\n                this.spinner.show(null, this.translateService.instant('a_toast_update_start'), true);\n                try {\n                    await this.dbUpdater.checkForUpdates();\n                } catch (e) {\n                    console.error('caught error while checking for updates:');\n                    console.error(e);\n                }\n            }\n        }\n        if (!this.gpsService.getLastPosition()) {\n            // try to get position\n            try {\n                await timeout(this.gpsService.getCurrentPosition().catch(err => {\n                    console.error(\"Error loading GPS data\", err)\n                }), 2000);\n            } catch (e) {\n                console.log(\"could not obtain position: \" + e.message);\n                // make position check async\n                this.gpsService.getCurrentPosition().then((position) => {\n                    if (position && position.coords) {\n                    }\n                }, err => {\n                    console.error(\"Error loading GPS data\", err)\n                });\n            }\n        }\n        this.items = await this.ormService.getVisibleRoutes(true, this.compareFunction);\n        this.downloadedItems = await this.ormService.getDownloadedRoutes(this.compareFunction);\n        this.filteredItems = this.items.slice(0, this.infiniteScrollBlockSize);\n        this.filterItems();\n\n        if(this.helper.getActivateAddRoute()){\n            this.addRouteByCode();\n            this.helper.setActivateAddRoute(false);\n        }\n\n    }\n\n    async doRefresh(refresher) {\n        let online = await this.modalsService.showNoInternetModalIfOffline();\n        if (online) {\n            try {\n                await this.dbUpdater.checkForUpdates();\n            } catch (e) {\n                console.error('caught error while checking for updates:', e);\n            }\n            this.items = await this.ormService.getVisibleRoutes(false, null, true);\n            this.sortAndRebuildFilteredItems();\n        }\n        refresher.complete();\n    }\n\n    async addRouteByCode() {\n        let route = await MCMRouteByCodeModal.show(this.navCtrl, this.modalCtrl, this.translateService, this.modalsService);\n        if (route) {\n            let alreadyAdded = false;\n            for (let i = 0; !alreadyAdded && i < this.items.length; i++) {\n                if (this.items[i].id == route.id) {\n                    // route has been added twice\n                    alreadyAdded = true;\n                }\n            }\n            if (!alreadyAdded) {\n                this.items.push(route);\n                this.sortAndRebuildFilteredItems();\n            }\n            this.scrollTo(route);\n        }\n    }\n\n    private compareFunction(a: Route, b: Route) {\n        const distA = a.getDistance();\n        const distB = b.getDistance();\n        if (distA > distB) {\n            return 1;\n        } else if (distA < distB) {\n            return -1;\n        }\n        return a.title.localeCompare(b.title);\n    }\n\n\n    scrollTo(route: Route) {\n        let that = this;\n        setTimeout(function () {\n            let element = document.getElementById('route-item-' + route.id);\n            if (element) {\n                that.content.scrollTo(0, element.offsetTop);\n            }\n\n        }, 300);\n    }\n\n    doInfinite(infiniteScroll) {\n        if (this.items.length > this.filteredItems.length) {\n            console.info(`Add ${this.infiniteScrollBlockSize} list items ...`);\n            let itemsToAdd = this.items.slice(this.filteredItems.length, this.filteredItems.length + this.infiniteScrollBlockSize);\n            itemsToAdd.forEach(item => this.filteredItems.push(item));\n        } else {\n            console.info('End of list reached');\n        }\n        setTimeout(() => {\n            infiniteScroll.complete();\n        }, 2000);\n    }\n\n    private sortAndRebuildFilteredItems() {\n        this.filteredItems = this.items.slice(0, this.filteredItems.length);\n    }\n\n/*    async reactOnDownloadedRoute(event) {\n        if (event && event.route) {\n            //this.modalsService.showRoute(event.route, this.navCtrl);\n        }\n    }*/\n\n    async switchToMap() {\n        //this.events.publish('changeViewType', (false));\n        this.navCtrl.setRoot('RoutesMapPage', {showAllRoutes: this.showAllRoutes});\n    }\n\n    async updateRoutes() {\n        this.downloadedItems = await this.ormService.getDownloadedRoutes(this.compareFunction);\n    }\n\n    showRouteDetail(item: any) {\n        if(!this.isOpeningRoute){\n            this.isOpeningRoute = true;\n            this.modalsService.showRoute(item, this.navCtrl).then(async () => {\n                this.isOpeningRoute = false;\n                await this.updateRoutes();\n            })\n        }\n\n    }\n\n    filterItems(){\n        let value;\n        if(this.showAllRoutes) value = this.getRoutesList();\n        else value = this.downloadedItems;\n        this.filteredResult = this.pipe.transform(value, 'title,city,code', this.routesListSearch)\n\n    }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/home/tabs/RoutesList/RoutesList.ts"],"sourceRoot":""}